<?xml version="1.0" encoding="UTF-8"?>
<project name="air-search-test" default="" basedir=".">

	<path id="classpath">
		<fileset dir="${libs.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="test.classpath">
		<fileset dir="${libs.dir}">
			<include name="**/*.jar" />
			<exclude name="**yatra/*.jar"/>
		</fileset>				
		<fileset dir="${libs.dir}/jars/yatra" includes="yatra_core.jar" />
		<fileset dir="${libs.dir}/jars/yatra" includes="air_model.jar" />
		<fileset dir="${libs.dir}/jars/yatra" includes="yatra_properties.jar" />
		<fileset dir="${libs.dir}/jars/yatra" includes="yatra_cache.jar" />
		<fileset dir="${libs.dir}/jars/yatra" includes="yatra_services.jar" />
		<fileset dir="${libs.dir}/jars/yatra" includes="yatra_ui.jar" />
		<fileset dir="${libs.dir}/jars/yatra" includes="yatra_cms.jar" />
		<fileset dir="${libs.dir}/jars/yatra" includes="yatra_role.jar" />
	</path>
	
	<target name="test" >
		
		<mkdir dir="${test.report.dir}/xml" />
		<mkdir dir="${test.report.dir}/html" />
		
		<javac 
			srcdir="${test.src.dir}" 
			destdir="${classes.dir}" 
			debug="on" 
			memoryinitialsize="256m" 
			memorymaximumsize="1024m" 
			fork="true">
			<classpath refid="classpath" />
		</javac>

		<junit printsummary="yes" haltonfailure="yes">
			<formatter type="xml"/>
			<classpath refid="test.classpath"/>
			<classpath>
		        <pathelement location="${libs.dir}/jars/test/junit-4.4.jar"/>
		    	<pathelement location="${classes.dir}"/>
			</classpath>
			<batchtest fork="yes" todir="${test.report.dir}/xml">
				<fileset dir="${test.src.dir}">
					<include name="**/*Test.java"/>
				</fileset>
			</batchtest>
		</junit>
		
		<junitreport todir="${test.report.dir}">
		  <fileset dir="${test.report.dir}/xml">
		    <include name="TEST-*.xml"/>
		  </fileset>
		  <report format="frames" todir="${test.report.dir}"/>
		</junitreport>
		
	</target>
	
</project>